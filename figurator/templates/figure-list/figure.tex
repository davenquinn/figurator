<# macro figid() -#>
Figure \ref{fig:<< id >>}
<#- endmacro #>
<# macro figref() -#>
\color{light-gray}\HaskligLight{fig:<< id|escape >>}
<#- endmacro #>

\begin{samepage}
\subsection[<< figid() >>~~~<< figref() >>~~~<#- if title #>\textit{<< title >>}<#- endif #>]%
  {<< figid() >><#- if title #>: \GothamLight{<< title >>} \hfill \figref{}<#- endif #>}
\nopagebreak
\noindent\centerline{\includegraphics[<< size >>]{<< file >>}}
<# if caption -#>
\nopagebreak
\captionof{figure}[<<title>>]{<< caption >>}
<#- else -#>
\captionlistentry[figure]{<< title >>}
<#- endif #>\label{fig:<< id >>}
<#- if not enabled #>
{\color{red}\textbf{Disabled}}
<# endif -#>
<#- if not referenced #>
{\color{red}\textbf{Unreferenced}}
<# endif -#>
<#- if desc #>
\nopagebreak
\begin{figinfo}<< desc >>\end{figinfo}
<# endif #>
\end{samepage}
\vspace{20pt}
